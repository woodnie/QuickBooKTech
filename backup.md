# Backup {#backup}

1、赛门铁克的Backup Exec和NetBackup

451 Group的分析师达弗辛普森(Dave Simpson)认为，不管怎么评选最佳备份应用软件，都少不了六家大厂商的产品。

他说：&quot;单纯从用户数量的角度来说，排名靠前的六大厂商分别是赛门铁克、IBM、EMC、CA Technologies、惠普和CommVault，赛门铁克的市场份额最高，排在第一位。&quot;

赛门铁克提供了两款最著名的备份产品。Backup Exec适用于Windows、Linux、Mac和各种虚拟化平台，整合了重复数据删除和归档技术。

CDW解决方案架构师迈克尔拉普提诺(Michael Lapetino)称：&quot;赛门铁克的Backup Exec非常适用于以Windows服务器为中心的同源环境。它主要面向磁带和磁盘备份策略相当普通的中小型企业。 BackupExec不但功能强大，价格低廉，而且兼容传统计算环境，深得客户们的喜爱。&quot;

NetBackup是赛门铁克旗下另一款得到用户广泛应用的备份产品。最新版NetBackup包括了Symantec V-Ray组件，支持虚拟文件系统和应用软件的备份。

2、EMC Networker

EMC Networker是一款顶级备份应用软件。但是，EMC在快速增长的备份应用软件市场上的份额越来越大。 IDC称，备份产品是备份领域发展速度最快的领域。备份/数据保护设备市场的规模已经达到16亿美元，EMC独占64%的收入份额。

与在软件领域的发展一样，EMC将重复数据删除和其他功能封装到备份产品之中。EMC将它从收购Data Domain和Avamar的交易中获得的重复数据删除功能与NetWorker和Disk Library备份软件整合在一起，成为备份领域中一支发展迅速的中坚力量。

EMC备份与恢复系统部门总裁BJ詹金(BJ Jenkins)称：&quot;Networker和Avamar以后也将整合在一起，它们都使用了来自Data Domain的功能。&quot;

3、IBM TSM

IBM Tivoli Storage Manager推出市场已有一些年头并拥有了一批忠实的用户。几年来，它不断增加各种新的功能，现在已经具备一整套适用于现代备份环境的功能。 重复数据删除、归档、分级存储管理以及快速备份都是其中最新的功能。

4、CA Technologies的ARCserve

CA Technologies是一家长期备份供应商，它的产品是ARCserve。与目前的大多数备份产品一样，ARCserve包括了重复数据删除、报告和虚拟服务器备份等功能。

拉普提诺称：&quot;以前，我们主要将CA的ARCserve Backup推荐给非常看重价值的中小型企业用户，它们希望缩小自己与大型企业在备份和业务连续性方面的差距。ARCserve套装包括丰富的功能和很强的灵活性，适用于混合操作系统环境。 它有一些可选相关组件，允许用户在一个界面下进行主机复制操作。&quot;

5、惠普的Data Protector

惠普是另一家进入重复数据删除领域的OEM厂商。惠普的Data Protector可以提供磁盘和磁带数据保护、快照、重复数据删除和许多其他功能。

6、CommVault的SimpanaCommVault最近取得了相当大的进展。

辛普森表示：&quot;CommVault似乎是现在发展速度最快的备份厂商，它与戴尔、HDS和NetApp都签订了OEM协议。&quot;

Commvault在攻击上述工具的传统特点上取得了很大的进展。由于那些工具已经存在了很多年的时间，有些功能已经无法满足现代云和虚拟化环境的需求。 CommVault推出的Simpana 9甚至包括了一些内建在软件中的工具，以减少用户从赛门铁克或IBM转移时的工作量。

7、FalconStor

FalconStor提供了两款备份产品。FalconStor Continuous Data Protector(CDP)可以是一款物理产品，也可以是一款虚拟产品，或者是SAN的网关。 FalconStor营销主管迈克迪美格里奥(Mike DiMeglio)称，它包括了自动灾难恢复和业务连续性技术、RecoverTrac(数据、文件、应用服务器或数据中心的快速恢复)。

FalconStor VTL(Virtual Tape Library)包括磁带媒体管理、重复数据删除和WAN优化等功能。

迪美格里奥称：&quot;FalconStor的备份优化解决方案可以用磁盘备份解决方案来替换或增强传统物理磁带备份解决方案，加快备份操作，提高备份可靠性和简化磁带管理工作。&quot;

8、Acronis

辛普森称，有两家备份厂商不太为人所知。他说，Acronis Backup &amp; Recovery现在已经拥有17.5万企业客户。它的备份解决方案包括中小型企业版、企业版和在线备份版等若干种版本。

9、Syncsort

辛普森称，Syncsort与NetApp建立了非常紧密的OEM合作关系，它的产品以NetApp Syncsort Integrated Backup(NSB)的形式体现。 Syncsort与NetApp、Avnet和Arrow建立了合作关系，据说它的解决方案是业内第一款完整的数据保护解决方案。NSB包括Syncsort备份管理软件和NetApp磁盘存储。

10、Virtual Server Backup

上述所有厂商都在积极完善各自的旗舰备份产品，让它们能够支持虚拟环境。因此，在这个领域中，相互借鉴学习是很有必要的。 辛普森认为有几家厂商在这方面做得比较好。

他说：&quot;由于备份/恢复最热门的领域是虚拟服务器，因此我比较看好Veeam Backup &amp; Replication和Quest Software的vRanger和NetVault/BakBone。&quot;

德鲁罗布(Drew Robb)是专注于技术和工程的自由撰稿人。他生于苏格兰，现在加利福尼亚定居。他在苏格兰斯特拉思克莱德大学获得地质与地理学士学位，曾编著《Windows环境下的服务器磁盘管理》一书。

### Symantec NBU {#symantec-nbu}

NetBackup 可以通过以下方式容纳多台服务器在一台 NetBackup 主服务器的管理控制下协同工作：

■ 主服务器管理备份、存档和还原。主服务器负责为 NetBackup 选择介质和设备。

通常，主服务器包含 NetBackup 目录库。该目录库包含内部数据库，内部数据

库中包含有关 NetBackup 备份和配置的信息。

■ 介质服务器允许 NetBackup 使用它们所挂接的存储设备，从而提供额外的存储

区域。介质服务器还可以通过分配网络负载来提高性能。介质服务器还可以用

于以下术语：

        ■ 设备主机（当存在磁带设备时）

        ■ 存储服务器（当直接向磁盘执行 I/O 时）

数据移动器（当向类似 OpenStorage 设备这样的独立外部磁盘设备发送数据时）备份或存档期间，客户端通过网络将备份数据发送到 NetBackup 服务器。 NetBackup 服务器管理在备份策略中指定的存储类型。

在还原过程中，用户可以进行浏览，然后选择要恢复的文件和目录。 NetBackup 查找选定的文件和目录，然后将它们还原到客户端上的磁盘。

### Backup VS HA {#backup-vs-ha}

3、关于备份(Backup)和高可用性(High availability)

备份，从字面的意思来理解，其实就是现时存在和应用的一个实体的后备实体；

高可用性，即是指我们硬件的环境、设施、数据、应用系统等，在复杂环境下可用的能力和可能性达到一个较高的值；

在现实世界里，我们都讲究有一个稳定，可靠，所以我们经常在计算机环境设计里，涉及到高可用性和备份等等元素。

我首先把这两个词拿出来说，就是不想让新手们在什么双机热备，数据备份亚，集群等等概念里晕的不也乐乎。

对于备份我主要说说以下几个方面：

   a、设备的备份

   设备的备份，也就是我们在现时使用的设备之外，采取相同或者类似的设备做后备。

   比如我们在服务器上采用冗余电源，也叫后备电源，我们使用单独的硬盘来做RAID的备用盘，也叫热备盘。

   如果我们采取单独的一台服务器来做后备，这就成了主机的备份，主机的备份有很多种方式，比较著名的就是所谓的cluster，所谓的双机热备和双机容错，我很不喜欢鼓捣这些概念，我一概称他们为主机热备，因为他们有一个共同的特点，就是都是为了实现主机的备份，即某一个主机失效了，有另外一个主机顶替它来运行。实现主机热备的软件有很多，比如IBM的HACMP，HP的MCSG，SUN的sun cluster，Compaq的Ture Cluster，Veritas的VCS，EMC的autostart，ROSE HA等等

   b、数据的备份

   数据的备份，就是我们在现时使用的数据之外，实现或设置另外一份不同物理体现的、内容相同的的有效数据拷贝

   比如我们将生产数据拷贝到磁带上，就是一种数据备份方式。

   比如我们将生产数据复制到磁盘的另一个分区，另一个文件系统，或者拷贝到别的主机的磁盘上，等等，都是一种数据备份的方式。

   实现数据备份的软件有很多，比如一些磁带操作的小工具，tar，cpio等，大的工具软件有什么EMC Networker, Symantec Netbackup，CommVault，tapeware等等，数据复制的工具就更多了，操作系统的复制命令呀，emc replicator呀，srdf等等

   c、应用系统的备份

   应该说应用系统的备份，包含了以上两种备份，因为一个完善的应用系统，其设备和数据都是要求有备份的，那么初次之外，做为一个应用系统，除了设备和数据，他还包含了业务程序，人员，业务逻辑，外部环境等等一系列让应用跑起来的东西。

   在这个层面，就有一个比较热火的东西，那就是常说的远程容灾。远程容灾，就是在生产系统环境之外，在相隔较远的物理空间，构建相同或类似的一个应用系统，以达到在必要的时候顶替原生产系统工作的目标。

   要实现远程容灾的目的，除了我们说的外部环境，比如机房，电力，后勤保障，人员配备，业务程序之外，我们比较着重的一个环节，就是数据的问题，也就是我们在两个系统之间要保证数据的相对一致，实现这个目标的方法有很多，比如磁盘阵列之间的卷复制，比如两个主机之间文件系统上的复制，等等。当然，在一个系统里，把数据用磁带导出来，快递到另外一个系统地点，在用磁带把数据导进取，也不能说不是一个办法，但是这样操作，经常会和业务的逻辑相违背（呵呵，这么麻烦又耽误时间，估计一般很难接受）。

对于高可用性，我要说的是：

   可用性，即是指在各种复杂环境下，我们的数据，应用等计算资源都可以保持使用的能力和可能性。比如服务器配备冗余电源，就提高了服务器的可用性，好理解，一个电源工作不正常或者能力不够的是候，服务器不受影响嘛。再比如，我们的磁盘阵列采用双控制器，当某个控制器和链路工作不正常的时候，数据的访问能平滑的过渡到另外一个控制器上和链路上，这也是提高了数据和存储设备的可用性。

   那么什么是高可用性呢，我们就是一切为了提高系统可用性的实现方法和结果。

   要拿出来说的就是cluster，或者双机什么的。我们为了实现生产的应用系统的高可用性，其中一个环节就是实现服务器的高可用性，就是某服务器失效或者能力不足时，应用能平滑的过渡到另外的主机上，也就是说对于应用系统来说，服务器保证了相对的可用

那备份和高可用性有什么区别呢？

   那我要说，这根本没有可比性！因为这是两个不同的概念，他们的着眼点是不同的。备份只是保证了有后备，而高可用性则是为了保证应用的尽快恢复。

   打个比方，我们说备份就好比买保险，买保险不能保证你平安无事，但是肯定能减轻损失。我们说搞可用性，就是安全气囊，ABS，能让你快速的重新开始或者说将危险消弭于萌芽时刻。

   所以说我们做备份和提高可用性，两手都不可放松，也不互相矛盾。就好比买了好车，你就不买保险，或者你买了保险，就可以飙车，都是愚蠢的。

### Incremental and Differential {#incremental-and-differential}

**Figure 41\. Incremental/** cumulative **backup**

**Figure 42\. Differential backup**

### 备份方式

http://taotao1240.blog.51cto.com/731446/839702

讲述三种比较常见的备份方式。

**1、LAN备份**

这 种方式很简单，直接在生产服务器上安装备份代理，部署一台备份服务器，这样即可完成备份，不过这种方式不适合数据量非常大的环境。因为如果备份数据量非常 大，会占用以太网的带宽，虽然说备份操作一般在晚上进行。但是这种方式还是不适合大数据量的情况。因此有了LAN free备份。

**2、LAN free备份**

 Lan free，顾名思义，即释放了LAN的压力。如上图所示，数据流直接从File server经过FC switch备份到Tape，而不经过Lan，这样就不会占用主网络的带宽。但是数据仍然会通过文件服务器的本地磁盘--内存—FC switch这步，因此仍然会消耗File server的资源。因此有了下面的Server Free备份来尽可能的减少生产服务器的压力。

**3、Server Free**

 server free,即备份时数据不流经服务器的总线和内存，如上图，文件服务器使用SAN的File Server Storage空间，现在需要备份文件服务器，则只需将File Server Storage的数据直接备份到Tape。此时文件服务器只需要发出SCSI扩展复制命令，剩下的事情就是File Server Storage和Tape之间的事情了，这样就减轻了文件服务器的很多压力，使它可以专注于对外提供文件服务，而不需要再消耗大量CPU、内存、IO在备 份的事情上了。

 或者还有一种方式即NDMP，Network Data Management Protocol，网络数据管理协议。它是一种支持智能数据存储设备、磁带库设备及备份应用程序之间互相通信以完成备份过程的通信协议。服务器只要向支持 NDMP协议的存储设备发送NDMP指令，即可让存储设备将其自己的数据直接发送到其他设备上，而不需要流经服务器主机。